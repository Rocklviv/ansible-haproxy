---
- name: Gather variables for each operating system
  include_vars: "{{ item }}"
  with_first_found:
    - "{{ ansible_distribution | lower }}-{{ ansible_distribution_version | lower }}.yml"
    - "{{ ansible_distribution | lower }}-{{ ansible_distribution_major_version | lower }}.yml"
    - "{{ ansible_os_family | lower }}-{{ ansible_distribution_major_version | lower }}.yml"
    - "{{ ansible_distribution | lower }}.yml"
    - "{{ ansible_os_family | lower }}.yml"
  tags:
    - always

- include: install.yml

- include: post_install.yml

- name: Create haproxy conf.d dir
  file:
    path: "{{ item.path }}"
    state: directory
    mode: "0755"
  with_items:
    - { path: "/etc/haproxy" }
    - { path: "/etc/haproxy/conf.d" }
